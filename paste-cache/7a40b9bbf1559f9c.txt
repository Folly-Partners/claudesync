IP Camera Integration: Complete Setup Guide                                                                       
                                                                                                                   
 Overview                                                                                                          
                                                                                                                   
 Goal: Get 8+ Hikvision cameras into Apple Home with AI-powered notifications and 24/7 recording.                  
                                                                                                                   
 Platform: Scrypted NVR running on your Apple Silicon Mac                                                          
                                                                                                                   
 Cost: ~$80/year (Scrypted NVR license for 8 cameras)                                                              
                                                                                                                   
 Time: ~2 hours for initial setup                                                                                  
                                                                                                                   
 ---                                                                                                               
 Prerequisites Checklist                                                                                           
                                                                                                                   
 Before starting, confirm you have:                                                                                
                                                                                                                   
 - Apple Silicon Mac that will stay on 24/7                                                                        
 - Apple TV (for HomeKit Secure Video hub)                                                                         
 - External USB drive for recordings (recommend 1TB+)                                                              
 - Admin credentials for your Hikvision cameras                                                                    
 - Camera IP addresses (or will discover via network scan)                                                         
 - Mac and cameras on the same network                                                                             
                                                                                                                   
 ---                                                                                                               
 Part 1: Prepare Your Mac                                                                                          
                                                                                                                   
 Step 1.1: Prevent Mac from Sleeping                                                                               
                                                                                                                   
 Your Mac needs to stay awake to record continuously.                                                              
                                                                                                                   
 1. Open System Settings (or System Preferences on older macOS)                                                    
 2. Go to Energy (or Energy Saver)                                                                                 
 3. Set these options:                                                                                             
   - "Prevent automatic sleeping when the display is off" → ON                                                     
   - "Wake for network access" → ON                                                                                
 4. If using a MacBook, keep it plugged in                                                                         
                                                                                                                   
 Step 1.2: Format External Drive                                                                                   
                                                                                                                   
 1. Connect your external USB drive                                                                                
 2. Open Disk Utility (Spotlight → "Disk Utility")                                                                 
 3. Select the external drive in the sidebar                                                                       
 4. Click Erase                                                                                                    
 5. Configure:                                                                                                     
   - Name: CameraStorage (or your preference)                                                                      
   - Format: APFS                                                                                                  
   - Scheme: GUID Partition Map                                                                                    
 6. Click Erase and wait for completion                                                                            
 7. The drive should now appear at /Volumes/CameraStorage                                                          
                                                                                                                   
 Step 1.3: Install Homebrew (if not already installed)                                                             
                                                                                                                   
 Open Terminal (Spotlight → "Terminal") and run:                                                                   
                                                                                                                   
 /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"                   
                                                                                                                   
 Follow the prompts. When done, close and reopen Terminal.                                                         
                                                                                                                   
 Verify installation:                                                                                              
 brew --version                                                                                                    
                                                                                                                   
 Should show something like: Homebrew 4.x.x                                                                        
                                                                                                                   
 ---                                                                                                               
 Part 2: Install Scrypted                                                                                          
                                                                                                                   
 Step 2.1: Install Scrypted via Homebrew                                                                           
                                                                                                                   
 In Terminal, run:                                                                                                 
                                                                                                                   
 brew install scrypted/scrypted/scrypted                                                                           
                                                                                                                   
 This installs Scrypted and all dependencies.                                                                      
                                                                                                                   
 Step 2.2: Start Scrypted Service                                                                                  
                                                                                                                   
 brew services start scrypted                                                                                      
                                                                                                                   
 To verify it's running:                                                                                           
 brew services list                                                                                                
                                                                                                                   
 Should show scrypted with status started.                                                                         
                                                                                                                   
 Step 2.3: Access Scrypted Web Interface                                                                           
                                                                                                                   
 1. Open Safari or Chrome                                                                                          
 2. Go to: https://localhost:10443                                                                                 
 3. You'll see a security warning (self-signed certificate) - click "Advanced" → "Proceed to localhost"            
 4. Create your admin account:                                                                                     
   - Username: (your choice)                                                                                       
   - Password: (strong password - you'll need this later)                                                          
 5. Click Create Account                                                                                           
                                                                                                                   
 Bookmark this page - you'll use it to manage cameras.                                                             
                                                                                                                   
 ---                                                                                                               
 Part 3: Add Your Cameras                                                                                          
                                                                                                                   
 Step 3.1: Install the ONVIF Plugin                                                                                
                                                                                                                   
 1. In Scrypted web UI, click Plugins in the left sidebar                                                          
 2. Search for: ONVIF                                                                                              
 3. Click Install on "ONVIF Camera Plugin"                                                                         
 4. Wait for installation to complete                                                                              
                                                                                                                   
 Step 3.2: Discover Cameras Automatically                                                                          
                                                                                                                   
 1. Click Devices in the left sidebar                                                                              
 2. Click the + button (Add Device)                                                                                
 3. Select ONVIF Camera                                                                                            
 4. Click Discover                                                                                                 
                                                                                                                   
 Scrypted will scan your network for ONVIF-compatible cameras.                                                     
                                                                                                                   
 Step 3.3: Add Each Camera                                                                                         
                                                                                                                   
 For each discovered camera:                                                                                       
                                                                                                                   
 1. Click on the camera in the discovery list                                                                      
 2. Enter credentials:                                                                                             
   - Username: (your camera admin username, often admin)                                                           
   - Password: (your camera password)                                                                              
 3. Click Add                                                                                                      
 4. Wait for Scrypted to connect and fetch camera capabilities                                                     
                                                                                                                   
 Step 3.4: If Auto-Discovery Doesn't Work                                                                          
                                                                                                                   
 Add cameras manually:                                                                                             
                                                                                                                   
 1. Click + → ONVIF Camera                                                                                         
 2. Enter camera details:                                                                                          
   - IP Address: (e.g., 192.168.1.100)                                                                             
   - HTTP Port: Usually 80 for Hikvision                                                                           
   - Username: Your camera admin username                                                                          
   - Password: Your camera password                                                                                
 3. Click Add                                                                                                      
                                                                                                                   
 Step 3.5: Verify Camera Feeds                                                                                     
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera in the Devices list                                                                        
 2. You should see a live video preview                                                                            
 3. If you see video, the camera is working                                                                        
                                                                                                                   
 Troubleshooting if no video:                                                                                      
 - Check IP address is correct                                                                                     
 - Verify username/password                                                                                        
 - Ensure camera is on same network as Mac                                                                         
 - Try accessing camera directly at http://<camera-ip> in browser                                                  
                                                                                                                   
 Step 3.6: Name Your Cameras                                                                                       
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera                                                                                            
 2. Click the Settings tab (gear icon)                                                                             
 3. Change Name to something descriptive:                                                                          
   - "Front Door"                                                                                                  
   - "Backyard"                                                                                                    
   - "Garage"                                                                                                      
   - etc.                                                                                                          
 4. This name will appear in Apple Home                                                                            
                                                                                                                   
 ---                                                                                                               
 Part 4: Configure HomeKit Integration                                                                             
                                                                                                                   
 Step 4.1: Install HomeKit Plugin                                                                                  
                                                                                                                   
 1. Go to Plugins in Scrypted                                                                                      
 2. Search for: HomeKit                                                                                            
 3. Click Install on "HomeKit Plugin"                                                                              
 4. Wait for installation                                                                                          
                                                                                                                   
 Step 4.2: Enable HomeKit for Each Camera                                                                          
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera in Devices                                                                                 
 2. Click Extensions tab                                                                                           
 3. Find HomeKit and toggle it ON                                                                                  
 4. Configure settings:                                                                                            
   - Accessory Type: Camera                                                                                        
   - Streaming: Enabled                                                                                            
                                                                                                                   
 Step 4.3: Pair with Apple Home                                                                                    
                                                                                                                   
 1. In Scrypted, click on HomeKit in the Devices list                                                              
 2. You'll see a QR Code and a pairing code                                                                        
 3. On your iPhone:                                                                                                
   - Open the Home app                                                                                             
   - Tap + → Add Accessory                                                                                         
   - Point camera at the QR code (or enter code manually)                                                          
 4. Assign the camera to a room                                                                                    
 5. Repeat for each camera (they may all pair together as a bridge)                                                
                                                                                                                   
 Step 4.4: Verify in Apple Home                                                                                    
                                                                                                                   
 On your iPhone/iPad:                                                                                              
                                                                                                                   
 1. Open Home app                                                                                                  
 2. You should see all your cameras                                                                                
 3. Tap a camera to view live feed                                                                                 
 4. Try it from outside your home (via cellular) to confirm remote access works                                    
                                                                                                                   
 ---                                                                                                               
 Part 5: Set Up Scrypted NVR (AI + Recording)                                                                      
                                                                                                                   
 Step 5.1: Subscribe to Scrypted NVR                                                                               
                                                                                                                   
 1. Go to https://scrypted.app                                                                                     
 2. Click Get Scrypted NVR                                                                                         
 3. Choose your plan:                                                                                              
   - 4 cameras: $40/year                                                                                           
   - 8 cameras: $80/year (you need this)                                                                           
   - Additional cameras: $10/camera/year                                                                           
 4. Complete purchase                                                                                              
 5. You'll receive a license key                                                                                   
                                                                                                                   
 Step 5.2: Install NVR Plugin                                                                                      
                                                                                                                   
 1. In Scrypted web UI, go to Plugins                                                                              
 2. Search for: NVR                                                                                                
 3. Click Install on "Scrypted NVR"                                                                                
 4. After installation, click on Scrypted NVR in Plugins                                                           
 5. Enter your License Key                                                                                         
 6. Click Activate                                                                                                 
                                                                                                                   
 Step 5.3: Configure Recording Storage                                                                             
                                                                                                                   
 1. Click on Scrypted NVR in Devices                                                                               
 2. Go to Settings                                                                                                 
 3. Set Recording Storage Path:                                                                                    
 /Volumes/CameraStorage/scrypted-recordings                                                                        
 4. Set Retention (how long to keep recordings):                                                                   
   - Recommended: 30 days (adjust based on drive size)                                                             
 5. Click Save                                                                                                     
                                                                                                                   
 Step 5.4: Enable Recording for Each Camera                                                                        
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera                                                                                            
 2. Go to Extensions tab                                                                                           
 3. Find Scrypted NVR and toggle it ON                                                                             
 4. Configure:                                                                                                     
   - Recording Mode: Continuous (24/7) or Motion-Only                                                              
   - Prebuffer: 10 seconds (captures footage before motion)                                                        
                                                                                                                   
 Step 5.5: Enable AI Detection                                                                                     
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera                                                                                            
 2. Go to Extensions tab                                                                                           
 3. Enable Object Detection                                                                                        
 4. Configure detection types:                                                                                     
   - Person                                                                                                        
   - Vehicle                                                                                                       
   - Animal                                                                                                        
   - Package                                                                                                       
 5. Set Detection Sensitivity (start with Medium)                                                                  
                                                                                                                   
 Step 5.6: Configure Detection Zones (Optional but Recommended)                                                    
                                                                                                                   
 This reduces false alerts from trees, passing cars on street, etc.                                                
                                                                                                                   
 1. Click on a camera                                                                                              
 2. Go to Detection Zones (if available)                                                                           
 3. Draw zones on the camera view:                                                                                 
   - Include zones: Areas to monitor (your driveway, door, etc.)                                                   
   - Exclude zones: Areas to ignore (street, swaying trees)                                                        
                                                                                                                   
 ---                                                                                                               
 Part 6: Configure HomeKit Secure Video                                                                            
                                                                                                                   
 HomeKit Secure Video (HKSV) provides:                                                                             
 - End-to-end encrypted recording stored in iCloud                                                                 
 - AI detection by Apple (person, animal, vehicle, package)                                                        
 - Rich notifications with thumbnails                                                                              
 - Face recognition (for people in your Photos)                                                                    
                                                                                                                   
 Step 6.1: Enable HKSV for Each Camera                                                                             
                                                                                                                   
 On your iPhone:                                                                                                   
                                                                                                                   
 1. Open Home app                                                                                                  
 2. Long-press on a camera → Camera Settings                                                                       
 3. Tap Recording Options                                                                                          
 4. Choose one of:                                                                                                 
   - Stream: Live view only, no recording                                                                          
   - Stream & Allow Recording: Records when motion detected                                                        
   - Off: Disable camera                                                                                           
 5. Select Stream & Allow Recording                                                                                
                                                                                                                   
 Step 6.2: Configure What to Record                                                                                
                                                                                                                   
 1. Still in Camera Settings → Recording Options                                                                   
 2. Under "Record", choose:                                                                                        
   - Any Motion: Records all movement                                                                              
   - Specific Motion: Only people, animals, or vehicles (recommended)                                              
 3. Tap Specific Motion and enable:                                                                                
   - People                                                                                                        
   - Animals                                                                                                       
   - Vehicles                                                                                                      
   - Packages (if available)                                                                                       
                                                                                                                   
 Step 6.3: Configure Notifications                                                                                 
                                                                                                                   
 1. In Camera Settings → Notifications                                                                             
 2. Enable notifications for:                                                                                      
   - Activity Notifications                                                                                        
 3. Configure when to notify:                                                                                      
   - When: When I'm Away, or Always                                                                                
   - Detection type: People, Animals, Vehicles, etc.                                                               
                                                                                                                   
 Step 6.4: Set Up Face Recognition (Optional)                                                                      
                                                                                                                   
 1. Camera Settings → Face Recognition                                                                             
 2. Enable Face Recognition                                                                                        
 3. Grant access to your Photos library                                                                            
 4. Now you'll get notifications like "John is at the front door"                                                  
                                                                                                                   
 ---                                                                                                               
 Part 7: Install Scrypted Mobile App                                                                               
                                                                                                                   
 For viewing recordings and managing cameras on the go:                                                            
                                                                                                                   
 Step 7.1: Download the App                                                                                        
                                                                                                                   
 1. Open App Store on iPhone                                                                                       
 2. Search for: Scrypted                                                                                           
 3. Download and install                                                                                           
                                                                                                                   
 Step 7.2: Connect to Your Server                                                                                  
                                                                                                                   
 1. Open Scrypted app                                                                                              
 2. When on home network:                                                                                          
   - App should auto-discover your server                                                                          
   - Or enter: https://localhost:10443                                                                             
 3. Log in with your Scrypted credentials                                                                          
                                                                                                                   
 Step 7.3: Enable Remote Access (Optional)                                                                         
                                                                                                                   
 To access Scrypted from outside your home:                                                                        
                                                                                                                   
 1. In Scrypted web UI, go to Settings                                                                             
 2. Click Scrypted Cloud (or set up your own solution like Tailscale)                                              
 3. Follow the setup to enable remote access                                                                       
                                                                                                                   
 ---                                                                                                               
 Part 8: Optimize Camera Streams                                                                                   
                                                                                                                   
 For best performance with 8+ cameras:                                                                             
                                                                                                                   
 Step 8.1: Configure Dual Streams                                                                                  
                                                                                                                   
 Most Hikvision cameras support multiple streams. Configure them:                                                  
                                                                                                                   
 Main Stream (for recording + HomeKit viewing):                                                                    
 - Resolution: 1080p or 4K                                                                                         
 - Codec: H.264 (best compatibility) or H.265 (saves storage)                                                      
 - Framerate: 15-20 fps                                                                                            
 - Bitrate: 2-4 Mbps                                                                                               
                                                                                                                   
 Sub Stream (for AI detection + thumbnails):                                                                       
 - Resolution: 640x480 or 720p                                                                                     
 - Codec: H.264                                                                                                    
 - Framerate: 10-15 fps                                                                                            
 - Bitrate: 512 Kbps - 1 Mbps                                                                                      
                                                                                                                   
 Step 8.2: Configure in Scrypted                                                                                   
                                                                                                                   
 For each camera:                                                                                                  
                                                                                                                   
 1. Click on the camera                                                                                            
 2. Go to Settings                                                                                                 
 3. Find Streams configuration                                                                                     
 4. Set:                                                                                                           
   - Main Stream URL: For recording/viewing                                                                        
   - Sub Stream URL: For detection                                                                                 
                                                                                                                   
 Scrypted often auto-detects these, but you can manually configure if needed.                                      
                                                                                                                   
 ---                                                                                                               
 Part 9: Final Verification Checklist                                                                              
                                                                                                                   
 Run through these tests:                                                                                          
                                                                                                                   
 Local Tests (on home network)                                                                                     
                                                                                                                   
 - All cameras visible in Scrypted web UI                                                                          
 - All cameras appear in Apple Home app                                                                            
 - Live view works for all cameras in Home app                                                                     
 - Walk in front of a camera → receive notification within 30 seconds                                              
 - Notification includes thumbnail image                                                                           
 - Can view recording in Scrypted NVR app                                                                          
                                                                                                                   
 Remote Tests (from cellular/away from home)                                                                       
                                                                                                                   
 - Can view cameras in Apple Home from cellular                                                                    
 - Receive notifications when away from home                                                                       
 - Can view recordings remotely (via Scrypted app or iCloud)                                                       
                                                                                                                   
 ---                                                                                                               
 Troubleshooting Common Issues                                                                                     
                                                                                                                   
 Camera shows "No Response" in HomeKit                                                                             
                                                                                                                   
 1. Check camera is online in Scrypted                                                                             
 2. Restart Scrypted: brew services restart scrypted                                                               
 3. In Home app, remove camera and re-pair                                                                         
                                                                                                                   
 Notifications not working                                                                                         
                                                                                                                   
 1. iPhone Settings → Notifications → Home → Enable                                                                
 2. Check "Focus" mode isn't blocking notifications                                                                
 3. In Home app, verify notification settings for camera                                                           
 4. Make sure Apple TV is on and connected                                                                         
                                                                                                                   
 Recording not saving                                                                                              
                                                                                                                   
 1. Verify external drive is mounted: ls /Volumes/CameraStorage                                                    
 2. Check disk has free space                                                                                      
 3. Verify path in Scrypted NVR settings is correct                                                                
 4. Check Scrypted logs for errors                                                                                 
                                                                                                                   
 High CPU usage                                                                                                    
                                                                                                                   
 With 8+ cameras on Apple Silicon, expect:                                                                         
 - 10-30% CPU during normal operation                                                                              
 - Spikes to 50%+ during detection                                                                                 
 - If consistently higher, reduce stream resolutions                                                               
                                                                                                                   
 Camera feed is laggy                                                                                              
                                                                                                                   
 1. Reduce main stream resolution to 1080p                                                                         
 2. Ensure camera and Mac are on same network (not across VLANs)                                                   
 3. Check network for bandwidth issues                                                                             
                                                                                                                   
 ---                                                                                                               
 Useful Commands                                                                                                   
                                                                                                                   
 # Start Scrypted                                                                                                  
 brew services start scrypted                                                                                      
                                                                                                                   
 # Stop Scrypted                                                                                                   
 brew services stop scrypted                                                                                       
                                                                                                                   
 # Restart Scrypted                                                                                                
 brew services restart scrypted                                                                                    
                                                                                                                   
 # View Scrypted logs                                                                                              
 tail -f ~/Library/Logs/Scrypted/scrypted.log                                                                      
                                                                                                                   
 # Check if Scrypted is running                                                                                    
 brew services list | grep scrypted                                                                                
                                                                                                                   
 # Check external drive is mounted                                                                                 
 df -h /Volumes/CameraStorage                                                                                      
                                                                                                                   
 ---                                                                                                               
 Upgrade Path: Adding Frigate Later                                                                                
                                                                                                                   
 If you find Scrypted's AI detection isn't accurate enough (too many false alerts, missing detections), you can    
 add Frigate:                                                                                                      
                                                                                                                   
 1. Install Docker on Mac (via Colima or OrbStack)                                                                 
 2. Run Frigate container with Apple Neural Engine detector                                                        
 3. Point Frigate to your camera RTSP streams                                                                      
 4. Connect Frigate to Scrypted as a detection source                                                              
 5. Keep using Scrypted for HomeKit integration                                                                    
                                                                                                                   
 This gives you the best AI detection while maintaining HomeKit support.                                           
                                                                                                                   
 ---                                                                                                               
 Support Resources                                                                                                 
                                                                                                                   
 - Scrypted Discord: https://discord.gg/scrypted                                                                   
 - Scrypted Documentation: https://docs.scrypted.app                                                               
 - Scrypted GitHub: https://github.com/koush/scrypted                                                              
 - HomeKit Troubleshooting: https://support.apple.com/homekit                                                      
                                                                                                                   
 ---                                                                                                               
 Your Configuration Summary                                                                                        
 ┌───────────────────┬──────────────────────────────────────────────┐                                              
 │     Component     │                    Value                     │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ Mac               │ Apple Silicon                                │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ HomeKit Hub       │ Apple TV                                     │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ Recording Storage │ External USB drive at /Volumes/CameraStorage │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ Cameras           │ 8+ Hikvision (via ONVIF)                     │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ NVR License       │ Scrypted NVR ($80/year for 8 cameras)        │                                              
 ├───────────────────┼──────────────────────────────────────────────┤                                              
 │ Detection         │ Person, Vehicle, Animal, Package             │                                              
 └───────────────────┴──────────────────────────────────────────────┘     
