# Deep Personality: Cards Redesign & Typography Fix

## Overview

Three main tasks:
1. Fix UnderstandMeCards to show actual content (currently broken due to data key mismatch)
2. Redesign cards as fun "baseball card" style with detailed, actionable content
3. Fix AI analysis typography - larger font, Claude's font family

---

## Part 1: Fix UnderstandMeCards Content (Critical Bug)

### Root Cause

**The component is looking for the wrong data keys.** The scoring system generates:
- `ipip_50` â†’ but component expects `bigFive` or `big_five`
- `ecr_s` â†’ but component expects `attachment`
- `pvq_21` â†’ but component expects `values`
- `onet_mini_ip` â†’ but component expects `riasec`
- `weims` â†’ but component expects `workMotivation`

### Fix: Update Data Extraction in UnderstandMeCards.tsx

**File:** `components/UnderstandMeCards.tsx`

Change all data lookups to use actual keys:

```typescript
// OLD (broken):
const bigFive = profile.assessments?.bigFive || profile.assessments?.big_five;

// NEW (correct):
const bigFive = profile.assessments?.ipip_50?.domainScores;

// OLD (broken):
const attachment = profile.assessments?.attachment;

// NEW (correct):
const attachment = profile.assessments?.ecr_s;

// OLD (broken):
const values = profile.assessments?.values;

// NEW (correct):
const values = profile.assessments?.pvq_21;

// OLD (broken):
const riasec = profile.assessments?.riasec;

// NEW (correct):
const riasec = profile.assessments?.onet_mini_ip?.scores;

// OLD (broken):
const workMotivation = profile.assessments?.workMotivation || profile.assessments?.work_motivation;

// NEW (correct):
const workMotivation = profile.assessments?.weims;
```

---

## Part 2: Relocate Cards

### Move from Wellbeing Section to Under "Train Your Personal AI"

**File:** `components/Dashboard.tsx`

**Current location:** Line ~2455 in the visualizations grid
**New location:** Below the "Train Your Personal AI" section header, above the analysis CTA

**Rationale:** Cards are shareable content related to AI-generated insights, so they belong with the AI section, not buried in wellbeing visualizations.

---

## Part 3: Redesign Cards as Baseball Cards

### Design Goals
- Fun, collectible baseball card aesthetic
- Detailed, actionable content (not just headers)
- Visual stats/ratings like a sports card
- Profile photo placeholder area
- Position/role title
- Key stats displayed prominently

### Baseball Card Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  HOW TO WORK WITH ME          â”‚
â”‚  â”‚  ðŸ¢    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  â”‚ ICON   â”‚  ROLE: The Creative Ideator    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš¡ COMMUNICATION STYLE                     â”‚
â”‚  â€¢ Prefers async over meetings             â”‚
â”‚  â€¢ Direct feedback appreciated             â”‚
â”‚  â€¢ Responds best to big-picture briefs     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ’ª STRENGTHS        â”‚  âš ï¸ WATCH OUT FOR   â”‚
â”‚  â€¢ Innovation        â”‚  â€¢ May miss details â”‚
â”‚  â€¢ Big ideas         â”‚  â€¢ Dislikes routine â”‚
â”‚  â€¢ Quick pivots      â”‚  â€¢ Can overcommit   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ“Š STATS                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 85 â”‚ â”‚ 72 â”‚ â”‚ 45 â”‚ â”‚ 90 â”‚ â”‚ 60 â”‚       â”‚
â”‚  â”‚ O  â”‚ â”‚ C  â”‚ â”‚ N  â”‚ â”‚ E  â”‚ â”‚ A  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… BEST TASKS FOR ME:                      â”‚
â”‚  Brainstorming, Strategy, Client Pitches   â”‚
â”‚                                             â”‚
â”‚  â“˜ Generated by Deep Personality           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Card Content - Make It Detailed & Actionable

**Work Card ("How to Work With Me")**
- Communication Style: 3-4 specific bullet points
- Strengths: Top 3-4 work strengths
- Watch Out For: 2-3 potential friction areas
- Best Tasks: What they excel at
- Big Five stats bar visualization

**Friendship Card ("How to Be My Friend")**
- Social Style: Introvert/extrovert, group vs 1-on-1
- What I Value: Loyalty, honesty, humor, etc.
- How to Support Me: Specific actions
- Let's Do Together: Activity suggestions
- Attachment style indicator

**Romantic Card ("How to Love Me")**
- Attachment Style: Clear label with what it means
- Love Language: Based on traits
- What I Need: Emotional needs
- Support Me By: Specific actions
- Avoid: What triggers insecurity

### Styling Approach

```css
/* Baseball card aesthetic */
.card {
  border: 3px solid;
  border-radius: 12px;
  background: linear-gradient(to-b, white, slate-50);
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

/* Stats boxes */
.stat-box {
  background: gradient;
  font-weight: bold;
  font-size: 1.5rem;
  min-width: 48px;
}

/* Card header */
.card-header {
  background: gradient by type;
  padding: 1rem;
  border-radius: 8px 8px 0 0;
}
```

---

## Part 4: Fix AI Analysis Typography

### Current Issues
- Font: Lora serif at 17px - user finds it too small
- User wants: Claude's font with better sizing

### Claude's Typography (Reference)
Claude uses system fonts with fallbacks:
```css
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
/* OR simply: */
font-family: system-ui, -apple-system, sans-serif;
```

Claude's body text is typically:
- Font size: 16-18px on desktop
- Line height: 1.5-1.6
- Color: #374151 (gray-700) or similar

### Changes to globals.css

**File:** `styles/globals.css`

```css
/* OLD */
.prose-report {
  font-family: 'Lora', Georgia, 'Times New Roman', serif;
  font-size: 1.0625rem; /* 17px */
  line-height: 1.75;
}

/* NEW */
.prose-report {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  font-size: 1.125rem; /* 18px - larger for readability */
  line-height: 1.65;
  letter-spacing: -0.01em;
}
```

### Changes to Dashboard.tsx MarkdownComponents

Update paragraph styling:
```tsx
// OLD
p: ({ children }) => (
  <p className="font-serif text-slate-600 dark:text-slate-400 leading-relaxed mb-4 text-[16px]">

// NEW
p: ({ children }) => (
  <p className="text-slate-700 dark:text-slate-300 leading-relaxed mb-5 text-[18px]">
```

Update list items:
```tsx
// OLD
li: ({ children }) => (
  <li className="font-serif text-[16px] text-slate-600 dark:text-slate-400">

// NEW
li: ({ children }) => (
  <li className="text-[18px] text-slate-700 dark:text-slate-300 leading-relaxed">
```

---

## Implementation Order

1. **Fix data key mismatch** in UnderstandMeCards.tsx (critical bug)
2. **Update typography** in globals.css and Dashboard.tsx MarkdownComponents
3. **Redesign card component** with baseball card layout
4. **Move cards location** in Dashboard.tsx to under AI section

---

## Files to Modify

| File | Changes |
|------|---------|
| `app/api/generate-card/route.ts` | **NEW** - Haiku API endpoint for card content |
| `components/UnderstandMeCards.tsx` | Fix data keys, redesign as baseball cards, add API calls |
| `components/Dashboard.tsx` | Move cards location, update MarkdownComponents typography |
| `styles/globals.css` | Update `.prose-report` font family and size |

---

## Content Generation: Claude Haiku API

### Why Haiku?
- **Fast**: ~1-2 second response time
- **Cheap**: ~$0.001 per card ($0.25/1M input, $1.25/1M output)
- **Smart enough**: Structured content generation is well within Haiku's capabilities

### New API Endpoint

**File:** `app/api/generate-card/route.ts` (NEW)

```typescript
import Anthropic from '@anthropic-ai/sdk';

const anthropic = new Anthropic();

export async function POST(req: Request) {
  const { profile, cardType } = await req.json();

  // Extract relevant data based on card type
  const bigFive = profile.assessments?.ipip_50?.domainScores;
  const attachment = profile.assessments?.ecr_s;
  const values = profile.assessments?.pvq_21;

  const prompt = buildCardPrompt(profile.name, cardType, bigFive, attachment, values);

  const response = await anthropic.messages.create({
    model: 'claude-3-5-haiku-20241022',
    max_tokens: 500,
    messages: [{ role: 'user', content: prompt }]
  });

  return Response.json({ content: response.content[0].text });
}
```

### Prompt Templates

**Work Card Prompt:**
```
Based on this person's personality data, generate a "How to Work With Me" card.

Name: ${name}
Big Five Traits:
- Openness: ${O}th percentile
- Conscientiousness: ${C}th percentile
- Extraversion: ${E}th percentile
- Agreeableness: ${A}th percentile
- Neuroticism: ${N}th percentile

Generate JSON with these fields:
{
  "role": "A fun 2-3 word title like 'The Creative Strategist'",
  "communicationStyle": ["3-4 specific bullet points"],
  "strengths": ["3-4 work strengths"],
  "watchOutFor": ["2-3 potential friction areas"],
  "bestTasks": ["3-4 tasks they'd excel at"]
}

Be specific and actionable. Use their actual percentiles to inform the content.
```

**Friendship Card Prompt:**
```
Based on this person's personality, generate a "How to Be My Friend" card.

Name: ${name}
Extraversion: ${E}th percentile
Agreeableness: ${A}th percentile
Openness: ${O}th percentile
Top Values: ${topValues}

Generate JSON:
{
  "socialStyle": "One line describing their social preferences",
  "whatIValue": ["3-4 things they value in friendships"],
  "howToSupportMe": ["3-4 specific actions"],
  "letsDo": ["3-4 activity suggestions based on their traits"]
}
```

**Romantic Card Prompt:**
```
Based on this person's attachment style and personality, generate a "How to Love Me" card.

Name: ${name}
Attachment: Anxiety=${anxiety}, Avoidance=${avoidance}
Neuroticism: ${N}th percentile
Agreeableness: ${A}th percentile
Extraversion: ${E}th percentile

Generate JSON:
{
  "attachmentStyle": "Secure/Anxious/Avoidant/Fearful-Avoidant",
  "attachmentMeaning": "One sentence explaining what this means",
  "whatINeed": ["3-4 emotional needs"],
  "supportMeBy": ["3-4 specific loving actions"],
  "avoid": ["2-3 things that trigger insecurity"]
}
```

### Caching Strategy

Cache generated cards in localStorage to avoid re-generating:
```typescript
const cacheKey = `card_${cardType}_${profile.id}`;
const cached = localStorage.getItem(cacheKey);
if (cached) return JSON.parse(cached);

// Generate new card...
localStorage.setItem(cacheKey, JSON.stringify(cardContent));
```

### Cost Estimate
- Input: ~300 tokens Ã— $0.25/1M = $0.000075
- Output: ~200 tokens Ã— $1.25/1M = $0.00025
- **Total: ~$0.0003 per card** (0.03 cents)
- All 3 cards: ~$0.001 (0.1 cents)

---

---

## Part 5: Fix Book/Podcast Recommendations

### Issues
1. Titles have unnecessary quotes: `"The War of Art"` â†’ `The War of Art`
2. No links to actually find/buy the books or podcasts

### Solution

Update the AI prompt in `app/api/analyze-parallel/route.ts` to:

1. **Remove quotes** from titles in the markdown output
2. **Add Amazon/Goodreads links** for books
3. **Add Spotify/Apple Podcast links** for podcasts

**Updated prompt section:**
```
## ðŸ“š Books for You

| Book | Author | Why It's Perfect for ${name} |
|------|--------|------------------------------|
| [The War of Art](https://www.amazon.com/s?k=The+War+of+Art+Steven+Pressfield) | Steven Pressfield | [Personal reason] |

## ðŸŽ§ Podcasts for You

| Podcast | Why ${name} Will Love It |
|---------|--------------------------|
| [The Tim Ferriss Show](https://open.spotify.com/show/5qSUyCrk9KR69lEiXbjwXM) | [Personal reason] |
```

**Link format:**
- Books: Amazon search URL `https://www.amazon.com/s?k=${encodeURIComponent(title + ' ' + author)}`
- Podcasts: Spotify search or direct show link if known

**Implementation:**
- Add instruction to AI prompt: "Format book titles as markdown links to Amazon search. Format podcast titles as links to Spotify. Do NOT use quotes around titles."

### File to Modify
| File | Changes |
|------|---------|
| `app/api/analyze-parallel/route.ts` | Update book/podcast prompt to include links, remove quotes |

---

## Summary

This plan fixes:
1. **Critical bug**: Cards showing empty because of data key mismatch
2. **UX request**: Move cards to more prominent location under AI section
3. **Design request**: Baseball card aesthetic with detailed, actionable content
4. **Typography request**: Larger, Claude-style sans-serif font for AI analysis
5. **Book/Podcast links**: Remove quotes, add Amazon/Spotify links
